<!doctype html>
<html>
  <head>
    <style>
      @font-face {
        font-family: 'ia-quattro-v';
        src: url('fonts/iAWriterQuattroV.ttf') format('truetype');
      }

      @font-face {
        font-family: 'ia-quattro-s';
        src: url('fonts/iAWriterQuattroS-Regular.ttf') format('truetype');
      }
    </style>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JIF</title>
    <link rel=stylesheet media=screen href="jif.css">
  </head>

  <body hbox=stretch ondrop="open_file(event)">
<!--    <div id=sidebar flex=0 class=ui vbox=start-stretch></div>-->

    <div flex=1 vbox=stretch>
      <pre id=ed scale=0 contenteditable="plaintext-only"></pre>
      <div id=menu class=ui hbox=start-stretch></div>
    </div>

    <script src="jif.js"></script>

    <script>
      menu([
        ['File', [
          ['New File', () => console.log('new file')],
          ['New Window', () => console.log('new file')],
          '---',
          // ['Open Project…', () => choose_project()],
          ['Open File…', () => choose_file()],
          '---',
          ['Save', () => console.log('save file')],
          '---',
          ['Page Setup…', () => console.log('print setup')],
        ]],
        ['Options', [
          ['Edit Config', show_config],
          ['Spell', toggle_spell],
          // ['Show Sidebar', () => togvis('#sidebar')],
        ]],
        '---',
        ['Cmd', [
          ['Enter Command', show_cli],
          ['View Log', show_log],
        ]],
        ['Stats', [
          ['chars'],
          ['words'],
        ]]
      ])

      $('#menu-Stats').on('mousedown', e => {
        let s = stat_calc()
        let nc = s.nchars.toLocaleString()
        let nw = s.nwords.toLocaleString()
        $('#menu-Stats-chars').innerText = nc+' Characters'
        $('#menu-Stats-words').innerText = nw+' Words'
      })

      configure(db.get('=config'))

      set_scale(db.get('scale') ?? 0)
      toggle_spell(db.get('spell') ?? false)

      if (location.hash == '#menu')
        togvis('#menu', true)
      else
        togvis('#menu', db.get('vis/menu') ?? true)

      // togvis('#sidebar', db.get('vis/sidebar') ?? false)


      JIF.autoload()

      window.on('beforeunload', () =>
        JIF.autosave(jif.curfile, ed.value))

    </script>
  </body>
</html>

